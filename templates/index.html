<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‹¤ì‹œê°„ ê°€ìœ„ë°”ìœ„ë³´ ì•„ë ˆë‚˜</title>
    <script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
    <style>
        :root { --primary: #4a90e2; --bg: #f0f2f5; }
        body { font-family: 'Pretendard', sans-serif; background: var(--bg); margin: 0; padding: 10px; display: flex; flex-direction: column; align-items: center; }
        
        /* ë°˜ì‘í˜• ì»¨í…Œì´ë„ˆ: PCì—ì„  ê°€ë¡œ, ëª¨ë°”ì¼ì—ì„  ì„¸ë¡œ */
        .main-container { 
            display: flex; flex-wrap: wrap; gap: 20px; width: 100%; max-width: 1000px; margin-top: 20px;
        }
        
        .card { background: white; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); padding: 20px; flex: 1; min-width: 300px; }
        
        /* ê²Œì„ ì„¹ì…˜ */
        .game-section { text-align: center; }
        .status-box { height: 100px; display: flex; align-items: center; justify-content: center; background: #f8f9fa; border-radius: 10px; margin: 20px 0; font-weight: bold; font-size: 1.2rem; }
        .btn-group { display: flex; justify-content: center; gap: 10px; }
        button { padding: 15px; border: none; border-radius: 10px; background: var(--primary); color: white; cursor: pointer; font-size: 1.1rem; flex: 1; transition: 0.2s; }
        button:active { transform: scale(0.95); }

        /* ì±„íŒ… ì„¹ì…˜ */
        .chat-section { display: flex; flex-direction: column; height: 400px; }
        #chat-window { flex: 1; overflow-y: auto; border: 1px solid #eee; padding: 10px; margin-bottom: 10px; border-radius: 5px; text-align: left; background: #fafafa; }
        .chat-input-group { display: flex; gap: 5px; }
        input { flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 5px; }
        
        .loading { animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.4; } 100% { opacity: 1; } }

        /* ëª¨ë°”ì¼ ìµœì í™” (í™”ë©´ í­ì´ 600px ì´í•˜ì¼ ë•Œ) */
        @media (max-width: 600px) {
            .main-container { flex-direction: column; }
            .card { min-width: 100%; padding: 15px; }
            .chat-section { height: 300px; }
        }
    </style>
</head>
<body>
    <h1>ğŸ® ê°€ìœ„ë°”ìœ„ë³´ ì•„ë ˆë‚˜</h1>
    <div class="main-container">
        <div class="card game-section">
            <h2 id="user-display">ì ‘ì† ì¤‘...</h2>
            <div class="status-box" id="status">ê°€ìœ„, ë°”ìœ„, ë³´ ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒí•˜ì„¸ìš”!</div>
            <div class="btn-group">
                <button onclick="sendChoice('ê°€ìœ„')">âœŒï¸ ê°€ìœ„</button>
                <button onclick="sendChoice('ë°”ìœ„')">âœŠ ë°”ìœ„</button>
                <button onclick="sendChoice('ë³´')">ğŸ–ï¸ ë³´</button>
            </div>
        </div>

        <div class="card chat-section">
            <h3>ğŸ’¬ ì‹¤ì‹œê°„ ì±„íŒ…</h3>
            <div id="chat-window"></div>
            <div class="chat-input-group">
                <input type="text" id="chat-input" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." onkeypress="if(event.keyCode==13) sendMessage()">
                <button onclick="sendMessage()" style="flex: 0;">ì „ì†¡</button>
            </div>
        </div>
    </div>

    <script>
        const socket = io(); // Renderì—ì„œëŠ” í´ë§ ì—†ì´ ë°”ë¡œ ì‚¬ìš© ê°€ëŠ¥
        let myName = "";

        socket.on('connect', () => {
            myName = prompt("ì‚¬ìš©í•  ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”:");
            if(!myName) myName = "ìµëª…_" + Math.random().toString(36).substr(2, 5);
            document.getElementById('user-display').innerText = `í”Œë ˆì´ì–´: ${myName}`;
            socket.emit('join', {name: myName});
        });

        function sendChoice(pick) {
            socket.emit('choice', {pick: pick});
            document.getElementById('status').innerHTML = '<span class="loading">ìƒëŒ€ë°©ì˜ ì„ íƒì„ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...</span>';
        }

        function sendMessage() {
            const input = document.getElementById('chat-input');
            if(input.value.trim()) {
                socket.emit('message', {msg: input.value});
                input.value = "";
            }
        }

        socket.on('new_message', (data) => {
            const win = document.getElementById('chat-window');
            win.innerHTML += `<div><strong>${data.name}:</strong> ${data.msg}</div>`;
            win.scrollTop = win.scrollHeight;
        });

        socket.on('game_result', (data) => {
            document.getElementById('status').innerHTML = 
                `ê²°ê³¼: ${data.winner}<br><small>${data.p1_name}(${data.p1_pick}) vs ${data.p2_name}(${data.p2_pick})</small>`;
        });
    </script>
</body>
</html>
